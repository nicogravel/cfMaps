# Optimization strategies in cortical connective field (CF) mapping

Benchmarks for different modelling procedures in cortical connective field (CF) mapping.

Please have a look [here](https://nicogravel.github.io/cfMaps/) for installation instructions, tutorials, and examples.

modeling. First, the former implementation in `mrVista` (using Matlab's `lscov`) [1,2], which implemented a grid search approach. Without further optimization, the parameter space revealed by this implementation match predefined grid value predictions. Second, the implementation part of the *connective field* branch of the [prfpy](https://github.com/VU-Cog-Sci/prfpy) Python package [3]. Using Python sci-kit learn optimization functions (implemented as part of the `prfpy` package), the parameter space this version provides also converges to predefined grid parameters. Third, a more recent Python implementation by So-Hyeon et al. (2024) [4] that implements a parameter refinement space using the [Broyden-Fletcher-Goldfarb-Shanno](https://en.wikipedia.org/wiki/Broyden%E2%80%93Fletcher%E2%80%93Goldfarb%E2%80%93Shanno_algorithm) optimization algorithm for gradient descent using sci-py functions. Fourth, another Python implementation that capitalizes on [automatic differentiation](https://en.wikipedia.org/wiki/Automatic_differentiation) using `TensorFlow` and CUDA (partly inspired in the recent Python package [braincoder](https://braincoder-devs.github.io/)) [5] to achieve highly efficient gradient descent. To coordinate this effort, we rely on widely used population receptive field mapping tools [6,7].


## How to cite 

If you use this code please cite using the following information:

Gravel, N., Renken, R., & Cornelissen, F. W. (2025). cfmap: Optimization strategies in cortical connective field (CF) mapping [Computer software]. Zenodo. https://doi.org/10.5281/zenodo.17373320

Alternatively, use this BibTeX entry:

```bibtex
@misc{Gravel_optCF_2025,
  author       = {Gravel, Nicol{\'a}s and Renken, Remco and Cornelissen, Frans W},
  title        = {cfmap: Optimization strategies in cortical connective field (CF) mapping},
  year         = {2025},
  publisher    = {Zenodo},
  doi          = {10.5281/zenodo.17373320},
  url          = {https://doi.org/10.5281/zenodo.17373320}
}
```

## References

[1] Haak, K. V., Winawer, J., Harvey, B. M., Renken, R., Dumoulin, S. O., Wandell, B. A., & Cornelissen, F. W. (2013). Connective field modeling. *NeuroImage*, 66, 376-384. https://doi.org/10.1016/j.neuroimage.2012.10.037

[2] Gravel, N., Harvey, B., Nordhjem, B., Haak, K. V., Dumoulin, S. O., Renken, R., Ćurčić-Blake, B., & Cornelissen, F. W. (2014). Cortical connective field estimates from resting state fMRI activity. *Front. Neurosci.*, 8, 339. https://doi.org/10.3389/fnins.2014.00339

[3] Knapen, T. (2021). Topographic connectivity reveals task-dependent retinotopic processing throughout the human brain. *Proceedings of the National Academy of Sciences*, 118(2), e2017032118. https://doi.org/10.1073/pnas.2017032118

[4] Yoo, S.-H., Kieslinger, A.-S., & Skeide, M. A. (2024). Population connective field modeling reveals proto-retinotopic visual cortex organization in the prenatal human brain. *bioRxiv*. https://doi.org/10.1101/2024.07.08.602507

[5] de Hollander, G., Renkert, M., Ruff, C. C., & Knapen, T. H. (2024). braincoder: A package for fitting encoding models to neural data and decoding stimulus features [Computer software]. Zenodo. https://doi.org/10.5281/zenodo.10778413

[6] Dumoulin, S. O., & Wandell, B. A. (2008). Population receptive field estimates in human visual cortex. *NeuroImage*, 39(2), 647-660. https://doi.org/10.1016/j.neuroimage.2007.09.034

[7] Benson, N. C., Jamison, K. W., Arcaro, M. J., Vu, A. T., Glasser, M. F., Coalson, T. S., Van Essen, D. C., Yacoub, E., Ugurbil, K., Winawer, J., & Kay, K. (2018). The Human Connectome Project 7 Tesla retinotopy dataset: Description and population receptive field analysis. *Journal of Vision*, 18(13), 23. https://doi.org/10.1167/18.13.23